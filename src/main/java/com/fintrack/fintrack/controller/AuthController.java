package com.fintrack.fintrack.controller;

import com.fintrack.fintrack.dto.AuthResponse;
import com.fintrack.fintrack.dto.LoginRequest;
import com.fintrack.fintrack.dto.RegisterRequest;
import com.fintrack.fintrack.service.AuthenticationService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/auth")
public class AuthController {

    @Autowired
    private AuthenticationService authService;

    @PostMapping("/register")
    public ResponseEntity<?> register(@RequestBody RegisterRequest request) {
        try {
            AuthResponse response = authService.register(request);
            return ResponseEntity.ok(response);
        } catch (RuntimeException e) {
            // Fix: Null-safe string comparison
            if (e.getMessage() != null && e.getMessage().equals("Username already exists")) {
                return ResponseEntity.badRequest().body("Username already exists");
            }
            return ResponseEntity.internalServerError().body("Registration failed");
        }
    }

    @PostMapping("/login")
    public ResponseEntity<?> login(@RequestBody LoginRequest request) {
        try {
            AuthResponse response = authService.login(request);
            return ResponseEntity.ok(response);
        } catch (RuntimeException e) {
            if (e.getMessage() != null && e.getMessage().equals("Invalid credentials")) {
                return ResponseEntity.badRequest().body("Invalid credentials");
            }
            return ResponseEntity.internalServerError().body("Login failed");
        }
    }
}







//<p>Lorem ipsum dolor sit amet. Aut amet doloribus aut fugiat blanditiis sed nisi dolores quo nobis eveniet! Est quas rerum in tempora animi eos laborum explicabo et magni accusamus sed placeat sint ex consectetur saepe non voluptatem voluptas. At animi galisum vel praesentium dolor et dolor voluptate vel obcaecati quibusdam aut fugiat quis ea odit ducimus. Hic consequatur tenetur et quia vitae non nesciunt eveniet et sint dolorem ut tempora vitae eum galisum explicabo et vero pariatur. </p><p>Non quos eligendi sed nostrum ipsa in perferendis recusandae. Qui nostrum ipsam et reiciendis excepturi est quia tempore At quam rerum in obcaecati sint. </p><p>Ex distinctio velit id deserunt perferendis qui laborum voluptatem rem ullam architecto est vitae incidunt aut dolorem fugiat? Qui provident quibusdam ad consequatur voluptatem hic ipsam dolor et quasi quibusdam ut nihil repellat ut dolores quod eum minima deleniti. </p><p>Rem incidunt nobis vel nostrum fugit rem voluptatem velit sit autem vitae vel perspiciatis nihil. Ut modi consequatur ex eius voluptatem et quam dolor nam ratione harum et earum natus non natus omnis sit facere tenetur. </p><p>Aut voluptas ipsum aut cumque illo et voluptatibus laboriosam. Vel aliquid recusandae non aspernatur nisi ea consequatur nostrum? A vitae galisum id possimus ipsa cum repellendus doloribus. Sed eligendi quos a beatae recusandae non perspiciatis animi. </p><p>Non eligendi consequatur quo labore nihil ab unde magnam vel tempore quia et unde asperiores est nostrum voluptatem! Et molestiae molestiae sit eligendi voluptatem est temporibus neque id temporibus expedita sit tempore iste? Vel praesentium aspernatur est fugit nostrum et dolorem similique et voluptatem explicabo ut dolore officia eos officia quod! In velit assumenda sed illo harum eum reiciendis cumque aut distinctio neque rem quasi voluptatem ut officia unde. </p><p>Sit consequatur nihil non architecto autem qui ullam assumenda ut quibusdam nobis aut sint nostrum est quis nobis. Non maxime tenetur in dolor porro et iste odit est numquam neque qui eius praesentium. </p><p>Quo dolores sunt quo dolorem cumque rem quia quia. Et ducimus fugiat ea esse earum non laudantium laborum in ullam illum eos repellat repudiandae! Ut doloremque officia qui quisquam molestiae vel optio excepturi ex internos ducimus in delectus explicabo quo quam voluptatum non tenetur cumque. </p><p>Est iste minima rem totam similique aut officiis ducimus et culpa ducimus et nobis magnam qui ipsa consequatur et consequatur dolores. Non perspiciatis voluptas aut fugiat aliquam ut nobis ullam aut alias blanditiis ut atque quae sed blanditiis harum aut cupiditate voluptatem. Ut eius aliquid sed minus ducimus sit quia facere et doloremque eius a quis nihil. Et quidem minima ut cumque internos eos ullam velit est officiis magnam est dolor alias? </p><p>Aut dolorem consequatur vel quam veritatis ea odit galisum a aspernatur suscipit ut consectetur sequi nam galisum cupiditate. Est iusto corporis 33 ipsam reiciendis ut modi obcaecati est veritatis nobis hic quia galisum eum dolor suscipit. A libero placeat non obcaecati eaque est iure quam. Vel laborum unde id quas minima At error enim in dolorum pariatur eos molestiae iste. </p><p>Eos rerum aliquid est excepturi pariatur eos dolorum explicabo qui dolores deleniti et nesciunt consequatur. A aspernatur minus et facere provident et tempore adipisci qui possimus dolorem non voluptas sunt. Vel eius consequatur et laboriosam incidunt sed numquam ipsum eum labore quidem et commodi itaque. Et quasi omnis ut omnis fugiat qui quia consequatur est dolores nihil et possimus quia. </p><p>Aut aspernatur consequuntur cum excepturi eveniet ab laudantium modi et nisi expedita quo sequi illum! Non dolorem consequuntur 33 laborum totam et consequatur amet et doloribus tempora et exercitationem nostrum? Qui quia optio est nulla labore vel tempore nisi 33 veniam illum. </p><p>Ut consequatur enim ad officia magnam qui earum minima est possimus beatae rem voluptates praesentium hic veniam quia. Et molestias internos a delectus nisi et libero beatae ut libero quam id sequi molestiae aut tempora omnis. Hic iure sint ut pariatur voluptatum sit exercitationem praesentium? Nam autem soluta vel corporis quas vel repellat placeat ut minus consequatur! </p><p>Et corporis aperiam eos internos quaerat sit voluptatem quae. Qui voluptas officia ut unde cupiditate et beatae incidunt. </p><p>Id velit quia eos ipsa repellat non sint aperiam sed odio quia aut consequuntur tempora et voluptatem perspiciatis? Cum porro dolorem ut voluptatem cupiditate eum dolorem doloribus. </p><p>Aut enim nemo ut incidunt porro qui sapiente voluptas quo sint autem aut explicabo nihil est atque placeat et ducimus vitae. Et nulla omnis eos rerum voluptatem et unde molestias ex voluptatem voluptatem ut alias obcaecati. Ab voluptatibus doloribus a nihil provident quo distinctio facilis quo illum labore id explicabo dignissimos in voluptas sint et consequuntur blanditiis. Eos voluptatum culpa non distinctio alias eum ratione sequi ut voluptatum ducimus! </p><p>Aut deleniti placeat non voluptas molestiae et officia inventore sed vero temporibus rem nihil galisum qui perspiciatis voluptate ex iusto illo. Non sint sunt et mollitia numquam qui dolores fugit aut explicabo facilis. </p><p>Ut possimus quasi aut beatae rerum est internos praesentium est dicta voluptate ut suscipit minima ex esse officia. Non beatae nemo 33 accusantium veritatis ab quis quas vel doloribus sapiente ab sint deserunt eos saepe veniam. Et possimus pariatur sed dolores tempore At possimus aperiam non nihil dolores est velit cupiditate et labore numquam. Aut voluptatum exercitationem sit quaerat quae sed nihil eligendi in corporis suscipit ea recusandae galisum quo numquam maiores non eaque facilis. </p><p>Rem quisquam recusandae et mollitia earum aut ullam dolores et sapiente dolor qui sint assumenda. Ab aperiam error et odio optio ex tenetur necessitatibus et possimus saepe. </p><p>Et rerum praesentium sit voluptas facilis sit galisum aspernatur non accusamus soluta. Non veritatis explicabo rem iure consequatur et voluptas quas rem distinctio quidem? Ad aspernatur quod ad saepe maiores aut explicabo cumque et Quis illo et tempora libero sed soluta nobis qui saepe voluptas. Cum voluptatem doloribus nam minima ipsum ut aperiam suscipit rem similique obcaecati est dolorem enim non dolores atque ut aspernatur amet. </p>
//<p>Lorem ipsum dolor sit amet. Aut amet doloribus aut fugiat blanditiis sed nisi dolores quo nobis eveniet! Est quas rerum in tempora animi eos laborum explicabo et magni accusamus sed placeat sint ex consectetur saepe non voluptatem voluptas. At animi galisum vel praesentium dolor et dolor voluptate vel obcaecati quibusdam aut fugiat quis ea odit ducimus. Hic consequatur tenetur et quia vitae non nesciunt eveniet et sint dolorem ut tempora vitae eum galisum explicabo et vero pariatur. </p><p>Non quos eligendi sed nostrum ipsa in perferendis recusandae. Qui nostrum ipsam et reiciendis excepturi est quia tempore At quam rerum in obcaecati sint. </p><p>Ex distinctio velit id deserunt perferendis qui laborum voluptatem rem ullam architecto est vitae incidunt aut dolorem fugiat? Qui provident quibusdam ad consequatur voluptatem hic ipsam dolor et quasi quibusdam ut nihil repellat ut dolores quod eum minima deleniti. </p><p>Rem incidunt nobis vel nostrum fugit rem voluptatem velit sit autem vitae vel perspiciatis nihil. Ut modi consequatur ex eius voluptatem et quam dolor nam ratione harum et earum natus non natus omnis sit facere tenetur. </p><p>Aut voluptas ipsum aut cumque illo et voluptatibus laboriosam. Vel aliquid recusandae non aspernatur nisi ea consequatur nostrum? A vitae galisum id possimus ipsa cum repellendus doloribus. Sed eligendi quos a beatae recusandae non perspiciatis animi. </p><p>Non eligendi consequatur quo labore nihil ab unde magnam vel tempore quia et unde asperiores est nostrum voluptatem! Et molestiae molestiae sit eligendi voluptatem est temporibus neque id temporibus expedita sit tempore iste? Vel praesentium aspernatur est fugit nostrum et dolorem similique et voluptatem explicabo ut dolore officia eos officia quod! In velit assumenda sed illo harum eum reiciendis cumque aut distinctio neque rem quasi voluptatem ut officia unde. </p><p>Sit consequatur nihil non architecto autem qui ullam assumenda ut quibusdam nobis aut sint nostrum est quis nobis. Non maxime tenetur in dolor porro et iste odit est numquam neque qui eius praesentium. </p><p>Quo dolores sunt quo dolorem cumque rem quia quia. Et ducimus fugiat ea esse earum non laudantium laborum in ullam illum eos repellat repudiandae! Ut doloremque officia qui quisquam molestiae vel optio excepturi ex internos ducimus in delectus explicabo quo quam voluptatum non tenetur cumque. </p><p>Est iste minima rem totam similique aut officiis ducimus et culpa ducimus et nobis magnam qui ipsa consequatur et consequatur dolores. Non perspiciatis voluptas aut fugiat aliquam ut nobis ullam aut alias blanditiis ut atque quae sed blanditiis harum aut cupiditate voluptatem. Ut eius aliquid sed minus ducimus sit quia facere et doloremque eius a quis nihil. Et quidem minima ut cumque internos eos ullam velit est officiis magnam est dolor alias? </p><p>Aut dolorem consequatur vel quam veritatis ea odit galisum a aspernatur suscipit ut consectetur sequi nam galisum cupiditate. Est iusto corporis 33 ipsam reiciendis ut modi obcaecati est veritatis nobis hic quia galisum eum dolor suscipit. A libero placeat non obcaecati eaque est iure quam. Vel laborum unde id quas minima At error enim in dolorum pariatur eos molestiae iste. </p><p>Eos rerum aliquid est excepturi pariatur eos dolorum explicabo qui dolores deleniti et nesciunt consequatur. A aspernatur minus et facere provident et tempore adipisci qui possimus dolorem non voluptas sunt. Vel eius consequatur et laboriosam incidunt sed numquam ipsum eum labore quidem et commodi itaque. Et quasi omnis ut omnis fugiat qui quia consequatur est dolores nihil et possimus quia. </p><p>Aut aspernatur consequuntur cum excepturi eveniet ab laudantium modi et nisi expedita quo sequi illum! Non dolorem consequuntur 33 laborum totam et consequatur amet et doloribus tempora et exercitationem nostrum? Qui quia optio est nulla labore vel tempore nisi 33 veniam illum. </p><p>Ut consequatur enim ad officia magnam qui earum minima est possimus beatae rem voluptates praesentium hic veniam quia. Et molestias internos a delectus nisi et libero beatae ut libero quam id sequi molestiae aut tempora omnis. Hic iure sint ut pariatur voluptatum sit exercitationem praesentium? Nam autem soluta vel corporis quas vel repellat placeat ut minus consequatur! </p><p>Et corporis aperiam eos internos quaerat sit voluptatem quae. Qui voluptas officia ut unde cupiditate et beatae incidunt. </p><p>Id velit quia eos ipsa repellat non sint aperiam sed odio quia aut consequuntur tempora et voluptatem perspiciatis? Cum porro dolorem ut voluptatem cupiditate eum dolorem doloribus. </p><p>Aut enim nemo ut incidunt porro qui sapiente voluptas quo sint autem aut explicabo nihil est atque placeat et ducimus vitae. Et nulla omnis eos rerum voluptatem et unde molestias ex voluptatem voluptatem ut alias obcaecati. Ab voluptatibus doloribus a nihil provident quo distinctio facilis quo illum labore id explicabo dignissimos in voluptas sint et consequuntur blanditiis. Eos voluptatum culpa non distinctio alias eum ratione sequi ut voluptatum ducimus! </p><p>Aut deleniti placeat non voluptas molestiae et officia inventore sed vero temporibus rem nihil galisum qui perspiciatis voluptate ex iusto illo. Non sint sunt et mollitia numquam qui dolores fugit aut explicabo facilis. </p><p>Ut possimus quasi aut beatae rerum est internos praesentium est dicta voluptate ut suscipit minima ex esse officia. Non beatae nemo 33 accusantium veritatis ab quis quas vel doloribus sapiente ab sint deserunt eos saepe veniam. Et possimus pariatur sed dolores tempore At possimus aperiam non nihil dolores est velit cupiditate et labore numquam. Aut voluptatum exercitationem sit quaerat quae sed nihil eligendi in corporis suscipit ea recusandae galisum quo numquam maiores non eaque facilis. </p><p>Rem quisquam recusandae et mollitia earum aut ullam dolores et sapiente dolor qui sint assumenda. Ab aperiam error et odio optio ex tenetur necessitatibus et possimus saepe. </p><p>Et rerum praesentium sit voluptas facilis sit galisum aspernatur non accusamus soluta. Non veritatis explicabo rem iure consequatur et voluptas quas rem distinctio quidem? Ad aspernatur quod ad saepe maiores aut explicabo cumque et Quis illo et tempora libero sed soluta nobis qui saepe voluptas. Cum voluptatem doloribus nam minima ipsum ut aperiam suscipit rem similique obcaecati est dolorem enim non dolores atque ut aspernatur amet. </p>
//<p>Lorem ipsum dolor sit amet. Aut amet doloribus aut fugiat blanditiis sed nisi dolores quo nobis eveniet! Est quas rerum in tempora animi eos laborum explicabo et magni accusamus sed placeat sint ex consectetur saepe non voluptatem voluptas. At animi galisum vel praesentium dolor et dolor voluptate vel obcaecati quibusdam aut fugiat quis ea odit ducimus. Hic consequatur tenetur et quia vitae non nesciunt eveniet et sint dolorem ut tempora vitae eum galisum explicabo et vero pariatur. </p><p>Non quos eligendi sed nostrum ipsa in perferendis recusandae. Qui nostrum ipsam et reiciendis excepturi est quia tempore At quam rerum in obcaecati sint. </p><p>Ex distinctio velit id deserunt perferendis qui laborum voluptatem rem ullam architecto est vitae incidunt aut dolorem fugiat? Qui provident quibusdam ad consequatur voluptatem hic ipsam dolor et quasi quibusdam ut nihil repellat ut dolores quod eum minima deleniti. </p><p>Rem incidunt nobis vel nostrum fugit rem voluptatem velit sit autem vitae vel perspiciatis nihil. Ut modi consequatur ex eius voluptatem et quam dolor nam ratione harum et earum natus non natus omnis sit facere tenetur. </p><p>Aut voluptas ipsum aut cumque illo et voluptatibus laboriosam. Vel aliquid recusandae non aspernatur nisi ea consequatur nostrum? A vitae galisum id possimus ipsa cum repellendus doloribus. Sed eligendi quos a beatae recusandae non perspiciatis animi. </p><p>Non eligendi consequatur quo labore nihil ab unde magnam vel tempore quia et unde asperiores est nostrum voluptatem! Et molestiae molestiae sit eligendi voluptatem est temporibus neque id temporibus expedita sit tempore iste? Vel praesentium aspernatur est fugit nostrum et dolorem similique et voluptatem explicabo ut dolore officia eos officia quod! In velit assumenda sed illo harum eum reiciendis cumque aut distinctio neque rem quasi voluptatem ut officia unde. </p><p>Sit consequatur nihil non architecto autem qui ullam assumenda ut quibusdam nobis aut sint nostrum est quis nobis. Non maxime tenetur in dolor porro et iste odit est numquam neque qui eius praesentium. </p><p>Quo dolores sunt quo dolorem cumque rem quia quia. Et ducimus fugiat ea esse earum non laudantium laborum in ullam illum eos repellat repudiandae! Ut doloremque officia qui quisquam molestiae vel optio excepturi ex internos ducimus in delectus explicabo quo quam voluptatum non tenetur cumque. </p><p>Est iste minima rem totam similique aut officiis ducimus et culpa ducimus et nobis magnam qui ipsa consequatur et consequatur dolores. Non perspiciatis voluptas aut fugiat aliquam ut nobis ullam aut alias blanditiis ut atque quae sed blanditiis harum aut cupiditate voluptatem. Ut eius aliquid sed minus ducimus sit quia facere et doloremque eius a quis nihil. Et quidem minima ut cumque internos eos ullam velit est officiis magnam est dolor alias? </p><p>Aut dolorem consequatur vel quam veritatis ea odit galisum a aspernatur suscipit ut consectetur sequi nam galisum cupiditate. Est iusto corporis 33 ipsam reiciendis ut modi obcaecati est veritatis nobis hic quia galisum eum dolor suscipit. A libero placeat non obcaecati eaque est iure quam. Vel laborum unde id quas minima At error enim in dolorum pariatur eos molestiae iste. </p><p>Eos rerum aliquid est excepturi pariatur eos dolorum explicabo qui dolores deleniti et nesciunt consequatur. A aspernatur minus et facere provident et tempore adipisci qui possimus dolorem non voluptas sunt. Vel eius consequatur et laboriosam incidunt sed numquam ipsum eum labore quidem et commodi itaque. Et quasi omnis ut omnis fugiat qui quia consequatur est dolores nihil et possimus quia. </p><p>Aut aspernatur consequuntur cum excepturi eveniet ab laudantium modi et nisi expedita quo sequi illum! Non dolorem consequuntur 33 laborum totam et consequatur amet et doloribus tempora et exercitationem nostrum? Qui quia optio est nulla labore vel tempore nisi 33 veniam illum. </p><p>Ut consequatur enim ad officia magnam qui earum minima est possimus beatae rem voluptates praesentium hic veniam quia. Et molestias internos a delectus nisi et libero beatae ut libero quam id sequi molestiae aut tempora omnis. Hic iure sint ut pariatur voluptatum sit exercitationem praesentium? Nam autem soluta vel corporis quas vel repellat placeat ut minus consequatur! </p><p>Et corporis aperiam eos internos quaerat sit voluptatem quae. Qui voluptas officia ut unde cupiditate et beatae incidunt. </p><p>Id velit quia eos ipsa repellat non sint aperiam sed odio quia aut consequuntur tempora et voluptatem perspiciatis? Cum porro dolorem ut voluptatem cupiditate eum dolorem doloribus. </p><p>Aut enim nemo ut incidunt porro qui sapiente voluptas quo sint autem aut explicabo nihil est atque placeat et ducimus vitae. Et nulla omnis eos rerum voluptatem et unde molestias ex voluptatem voluptatem ut alias obcaecati. Ab voluptatibus doloribus a nihil provident quo distinctio facilis quo illum labore id explicabo dignissimos in voluptas sint et consequuntur blanditiis. Eos voluptatum culpa non distinctio alias eum ratione sequi ut voluptatum ducimus! </p><p>Aut deleniti placeat non voluptas molestiae et officia inventore sed vero temporibus rem nihil galisum qui perspiciatis voluptate ex iusto illo. Non sint sunt et mollitia numquam qui dolores fugit aut explicabo facilis. </p><p>Ut possimus quasi aut beatae rerum est internos praesentium est dicta voluptate ut suscipit minima ex esse officia. Non beatae nemo 33 accusantium veritatis ab quis quas vel doloribus sapiente ab sint deserunt eos saepe veniam. Et possimus pariatur sed dolores tempore At possimus aperiam non nihil dolores est velit cupiditate et labore numquam. Aut voluptatum exercitationem sit quaerat quae sed nihil eligendi in corporis suscipit ea recusandae galisum quo numquam maiores non eaque facilis. </p><p>Rem quisquam recusandae et mollitia earum aut ullam dolores et sapiente dolor qui sint assumenda. Ab aperiam error et odio optio ex tenetur necessitatibus et possimus saepe. </p><p>Et rerum praesentium sit voluptas facilis sit galisum aspernatur non accusamus soluta. Non veritatis explicabo rem iure consequatur et voluptas quas rem distinctio quidem? Ad aspernatur quod ad saepe maiores aut explicabo cumque et Quis illo et tempora libero sed soluta nobis qui saepe voluptas. Cum voluptatem doloribus nam minima ipsum ut aperiam suscipit rem similique obcaecati est dolorem enim non dolores atque ut aspernatur amet. </p>
